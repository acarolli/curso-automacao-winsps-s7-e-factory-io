# Módulo 3: Introdução ao Ambiente WinSPS-S7

Após estabelecermos uma base sólida nos fundamentos da automação, CLPs e na linguagem Ladder, é o momento de conhecermos a ferramenta que nos permitirá colocar esse conhecimento em prática sem a necessidade de um CLP físico: o WinSPS-S7. Este software é um simulador e ambiente de programação que emula o comportamento de CLPs da família Siemens S7, tornando-se uma excelente plataforma de aprendizado para estudantes e profissionais que desejam desenvolver suas habilidades em programação Ladder.

O WinSPS-S7 foi desenvolvido especificamente com o propósito educacional, oferecendo uma interface simplificada em comparação com os ambientes de desenvolvimento profissionais como o STEP 7 Classic ou o TIA Portal da Siemens, mas mantendo a essência da programação Ladder e da lógica de funcionamento dos CLPs S7. Ele permite criar, editar, testar e depurar programas Ladder, além de simular a interação com entradas e saídas, o que é fundamental para verificar o comportamento da lógica de controle antes de aplicá-la em um sistema real (ou, no nosso caso, no Factory IO).

A instalação do WinSPS-S7 geralmente é um processo direto. Normalmente, envolve baixar o arquivo de instalação do site oficial ou de fontes educacionais e seguir as instruções do assistente de instalação. É importante verificar os requisitos de sistema, embora o WinSPS-S7 seja relativamente leve e funcione bem na maioria dos computadores com sistema operacional Windows. Após a instalação, pode ser necessário realizar alguma configuração inicial mínima, como a seleção do idioma da interface, se disponível.

Ao iniciar o WinSPS-S7 pela primeira vez, você será apresentado à sua Interface Gráfica do Usuário (GUI). Embora possa parecer um pouco diferente das ferramentas mais modernas da Siemens, seus componentes principais são facilmente identificáveis e cumprem as funções essenciais para a programação e simulação. Os elementos chave da interface incluem:

1.  **Editor Ladder:** Esta é a área principal onde você escreverá seu programa. Ele permite inserir contatos (NA, NF), bobinas (simples, Set, Reset), temporizadores, contadores e outras instruções Ladder, organizando-os em redes (rungs). A interface geralmente oferece uma barra de ferramentas com acesso rápido aos elementos Ladder mais comuns.
2.  **Tabela de Símbolos (Symbol Table / Symbolik):** Uma parte crucial da programação organizada. Aqui, você define nomes simbólicos (tags) para os endereços absolutos das entradas (I), saídas (Q), memórias internas (M), temporizadores (T), contadores (C) e blocos de dados (DBs). Usar nomes significativos (como `Sensor_Esteira_Entrada` em vez de `I0.1`) torna o programa imensamente mais legível e fácil de manter. O WinSPS-S7 permite criar e gerenciar essa tabela.
3.  **Janela de Status/Monitoramento (Status Variable / Beobachten):** Quando o programa está sendo executado no CLP simulado (modo Online), esta janela é vital. Ela permite visualizar o estado atual das variáveis (entradas, saídas, memórias, valores de temporizadores e contadores) em tempo real. Observar como os valores mudam enquanto a lógica Ladder é executada é fundamental para entender o comportamento do programa e para depurar erros.
4.  **Área de Mensagens/Compilação:** Geralmente localizada na parte inferior da tela, esta área exibe mensagens do sistema, incluindo erros de sintaxe encontrados durante a compilação do programa ou informações sobre o processo de download para o simulador.

O primeiro passo para criar um programa é iniciar um **novo projeto**. No WinSPS-S7, isso geralmente envolve ir ao menu "Arquivo" (ou equivalente) e selecionar "Novo". Você pode ser solicitado a escolher um tipo de CPU simulada (por exemplo, uma CPU da série S7-300). Embora a escolha exata possa não ter um impacto drástico no aprendizado inicial com WinSPS-S7, é bom estar ciente dessa etapa. Algumas configurações básicas do projeto, como o nome e o local de salvamento, também serão definidas aqui.

Com o projeto criado, o foco se volta para o **Editor Ladder**. Utilizando a barra de ferramentas ou menus, você começará a inserir os elementos Ladder para construir sua lógica. Por exemplo, para criar uma lógica simples onde um botão (I0.0) liga uma lâmpada (Q0.0), você inseriria um contato NA associado ao endereço I0.0 e uma bobina associada ao endereço Q0.0 na mesma rede. É importante começar a usar a Tabela de Símbolos desde cedo, definindo `Botao_Liga` para I0.0 e `Lampada_Saida` para Q0.0, e então usar esses nomes simbólicos no editor Ladder.

Após escrever algumas redes de lógica, o próximo passo é a **compilação**. O compilador do WinSPS-S7 analisará seu código Ladder em busca de erros de sintaxe (como elementos mal conectados, endereços inválidos, etc.). Se erros forem encontrados, eles serão listados na área de mensagens, geralmente indicando a rede e a natureza do problema. Você precisará corrigir esses erros antes de prosseguir. Uma compilação bem-sucedida significa que o programa está sintaticamente correto e pronto para ser transferido para o CLP simulado.

O processo de **download** (ou "carregar" / "transferir") envia o programa compilado da ferramenta de programação para a memória do CLP simulado. No WinSPS-S7, haverá um comando específico para iniciar essa transferência. O software se comunicará com seu próprio motor de simulação interno para carregar o código. Após o download, o CLP simulado precisa ser colocado no modo de execução (RUN) para que ele comece a executar o ciclo de scan (ler entradas, processar lógica, escrever saídas).

Uma vez que o CLP simulado esteja em modo RUN, você pode ativar o **modo de monitoramento (Online)**. Isso permite visualizar a execução do programa Ladder em tempo real diretamente no editor. Os elementos Ladder que estão conduzindo a lógica (contatos fechados, bobinas energizadas) geralmente são destacados com uma cor diferente (como verde), e os valores atuais das variáveis (temporizadores, contadores) podem ser exibidos. Esta é uma ferramenta poderosa para entender como seu programa funciona passo a passo.

Durante o teste e a depuração, muitas vezes é útil simular o acionamento de entradas ou forçar o estado de saídas sem depender de sinais externos (que ainda não temos, até conectarmos ao Factory IO). O WinSPS-S7 oferece **ferramentas básicas de debugging**, como a capacidade de **Forçar (Force)** o estado de entradas e saídas diretamente pela interface de monitoramento ou por uma tabela específica. Por exemplo, você pode forçar a entrada `Botao_Liga` (I0.0) para o estado LIGADO e observar se a `Lampada_Saida` (Q0.0) acende no monitoramento, validando sua lógica simples.

Dominar a interface e as funcionalidades básicas do WinSPS-S7 é o primeiro passo prático em nossa jornada. Experimente criar projetos simples, usar a tabela de símbolos, programar as instruções básicas que aprendemos no Módulo 2, compilar, fazer o download, monitorar e forçar variáveis. Essa familiarização será essencial para os próximos módulos, onde integraremos nosso CLP simulado com o ambiente 3D do Factory IO.
